#!./topographica 
# Script to run Topographica test modules.
#
# do './topographica runtests -h' in topographica directory for usage.
#
# jbednar050109: This file should be renamed runtests.py or
# runtests.ty so that it can be loaded as a Python module.  It should
# also presumably be put into the tests directory somewhere, and a
# make target added for it so that "make tests" works.  The default
# set of tests run should not be *all* tests, just all unit tests (and
# not lengthy or large-scale functional tests)

import unittest
import tests
import getopt,sys

USAGE = """

usage: runtests [opts] [testmodule ...]

Runs the given test modules.  Runs all test modules if no arguments.

options:
   -v level : set the verbosity level (0,1,2,...)
   -h       : print this message and exit
"""

try:
    opts,args = getopt.getopt(sys.argv[1:],'v:')
except getopt.GetoptError,err:
    print USAGE
    sys.exit()

opts = dict(opts)

if '-h' in opts:
    print USAGE
    sys.exit()

if '-v' in opts:
    verbosity = int(opts['-v'])
else:
    verbosity = 1

if args:
    suite = unittest.TestSuite()
    suite.addTests([getattr(tests,module).suite for module in args])
else:
    suite = tests.suite

unittest.TextTestRunner(verbosity=verbosity).run(suite)

# foo
		 CODING CONVENTIONS FOR TOPOGRAPHICA

$Id$

This file specifies conventions to be used for code and documentation
for the Topographica simulator.  By default, all code is assumed to be
written in Python; special notes may be added for other languages such
as C++ as needed.


PYTHON CODING CONVENTIONS

By default, the project uses the standard set of Python coding
conventions written by Guido van Rossum, Python's author:

  http://www.python.org/doc/essays/styleguide.html

These need not be followed to the letter; they simply help resolve
differences between Topographica authors if there are disagreements.

One particular guideline of these that Jim does not always follow is
that he likes to use lines much longer than 80 characters, e.g. for a
string.  Other differences are listed elsewhere in this file, such as
in the REVISION INFO section.


REVISION INFO

Every readable file (i.e. text, source code, html, etc.) should
include an "Id" tag so that the CVS revision information will be
visible immediately, even in files outside of the CVS repository.

For text files, the Id tag should be placed near the top, surrounded
by dollar signs, on a line by itself.  Near the bottom is also
acceptable, but not preferred.  See the top of this file for an
example; CVS fills in all but the letters "Id" and the dollar signs.

For Python files, the Id tag should be placed at the end of the Python
doc string for that module, surrounded by dollar signs, on a line by
itself.  In addition, just after the doc string, the version number of
the file should be declared.  For example:

  """
  The module documentation...

  {dollar}Id{dollar}
  """
  __version__ = "{dollar}Revision{dollar}"

where {dollar} should be replaced with a dollar sign ($).


TEST SUITE

Every Python module should have a corresponding unit test in tests/.
The tests should be nearly exhaustive, in the sense that it should be
unlikely that a good-faith re-implementation of the module would pass
the tests but have significant bugs. Obviously, truly exhaustive tests
capable of detecting arbitrary (e.g. deliberate) errors would be
impractical.

The default set of unit tests that are run must complete very quickly,
with no extraneous output, no GUI windows popping up, etc., because
these tests are (and should be) run automatically many times each day
during active development.  Additional more expensive tests, GUI
tests, or those requiring user input or user examination of the output
are also encouraged, but all these must be kept separate from the main
automated regression tests.


NUMERICAL UNITS IN THE USER INTERFACE

All quantities visible to the user, such as GUI labels, parameters,
etc. must be in appropriate units that are independent of simulation
or implementation details.  For instance, all coordinates and
subregions of sheets must be in Sheet coordinates, not e.g. exposing
the row and column in the underlying matrix.  Similarly, unit
specifiers should be in Sheet coordinates, selecting the nearest
appropriate unit, not row and column.

Appropriate units for most parameters can be determined by considering
the continuous plane underlying the discrete units forming the model
sheet, and the continuous logical timeline behind the discrete
timesteps in the model. Some parameters should be expressed in terms
of lengths in that plane, some in terms of areas, and some in terms of
volumes, rather than numbers of units, etc.  Others are expressed in
terms of lengths of time, rather than number of time steps.  More
information is available in Bednar et al, Neuroinformatics, 2004.
There is usually only one correct answer for how to specify a
particular parameter, so please discuss it with all, or at least with
Jim, before picking a unit arbitrarily.


GUI

No part of Topographica should import GUI files, rely on the presence
of any GUI, or assume that the data it generates will be used by a GUI
unless it is absolutely necessary, e.g. for the actual GUI files.
Many components that would at first glance seem to be GUI-related are
in fact much more general, and should be written for the general case,
not in terms of the GUI (and not even with names or comments that
suggest they are limited to being part of a GUI).

For instance, many of the analysis and plotting routines will be
commonly used in the context of a GUI.  However, the vast majority of
those are not GUI-specific per se, i.e. they do not require a user to
actually move a mouse or manipulate widgets.  E.g. a SheetView is a
bitmap representation of a Sheet; the resulting bitmap can of course
be displayed in a GUI window, but it could also be saved to a file,
and in batch mode often *will* be saved directly to a file, with no
GUI window ever created.  What most plotting does is independent of
the output device, and any code for it should be written with
terminology like Plotting, not GUI.  Similarly for other analysis
routines; they should be in terms of some general module like
Analysis, not GUI.

Obviously, it's very helpful for plots, etc. to have interactive
widgets to set the scales, select subplots, etc.  But these can
generally be implemented in a way that can also be specified
textually, i.e. without a mouse, so that they can be used without a
GUI, or at least without any particular GUI.  

Search the web for Model-View-Controller for more information on this
approach.

Writing the code in this way helps ensure that the core of the
simulator is not dependent on any particular output device, which is
crucial because different output devices are appropriate in different
contexts, and because GUI libraries often vary quite quickly, and to
be able to maintain our code over the long term we need to minimize
the amount of our code that depends on such varying details.
